# sales-tracking-api

Sales Tracking API is an example of an API, which allows users to track their sales.

This API written in Python using [aiohttp](https://docs.aiohttp.org/en/stable/index.html) framework.


## Requirements

This application was written, tested and built with:
- Python (version 3.10.12)
- AIOHTTP (version 3.9.3)
- PostgreSQL (version 16.1)
- Docker (version 20.10.17)

## Executable binaries

This app has 2 main executable binary files (which are generated by [setup.py](https://github.com/temaxuck/sales-tracking-api/blob/main/setup.py) python script):

- sales-api - HTTP server, the API server itself
- sales-db - tool to manage migrations of the database

## Getting started

### Get the source code of the application

```console
$ cd /path/to/repos
$ git clone git@github.com:temaxuck/sales-tracking-api.git
$ cd sales-tracking-api
```

### Create and activate python virtual environment

```console
$ python3 -m venv venv
$ . venv/bin/activate
```

### Install this package

You can provide `-e` flag to `pip install` command if you are willing to change the source code of the application

```console
$ pip install .
```

### Set up your database

This application is written to use PostgreSQL as a database.

So before you start the application you can either:
- Set up your database your own way (you will have to provide `--pg-url=your-database-url` argument to `sales-api` binary or set `SALES_PG_URL` environment variable)
- Or run command `make postgres`. This will create and run [Docker](https://www.docker.com/) container based on PostgreSQL image with credentials _admin:admin_.

### Apply database migrations

To apply database migrations for your database use `sales-db --pg-url=your-database-url upgrade head`.

### Run the application

To run the application you can either:
- Build it with `docker build .` and then run the docker container with `docker run --name sales-tracking-api -d -p 8080:8080 -e  SALES_PG_URL=your-postgresql-url sales-tracking:0.1.0`
- Or simply run it on your machine locally with `sales-api --pg-url=your-postgresql-url`

### Run tests

```console
$ pytest
```

## CI

For this project I use [Github Actions](https://docs.github.com/en/actions) tools. Github Actions workflow configuration file is located at [`.github/workflows/CI.yml`](https://github.com/temaxuck/sales-tracking-api/blob/main/.github/workflows/ci.yaml)
